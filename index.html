<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="css/sliderStyle.css">
    <link rel="stylesheet" href="css/button.css">
    <link rel="stylesheet" href="css/selection.css">
    <title>Ecosystem Simulation</title>
</head>
<!--Load the AJAX API-->
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

</script>

<body style="margin: 0; overflow: hidden">
<script src="js/library/stats.min.js"></script>
<script src="js/util/loadData.js" type="module"></script>
<script src="/js/app.js"></script>
<script type="module" src="/js/threeStarter.js"></script>
<script src="js/util/perlinNoise.js"></script>
<script type= "module" src="js/util/domElementHandlers.js"></script>
<script src="js/util/chartDrawer.js"></script>
<script src="js/util/AStar.js" type="module"></script>
<script src="js/parameters.js"></script>
<script src="js/library/dat.gui.min.js"></script>
<script src="js/gui/gui.js"></script>
<script src="js/world/World.js" type="module"></script>
<script src="js/world/Grid.js" type="module"></script>
<script src="js/mouse/drawerHandler.js" type="module"></script>
<script src="js/mouse/mouse_picking.js" type="module"></script>
<script src="js/world/ObjectBases.js" type="module"></script>
<script src="js/world/Objects.js" type="module"></script>
<script src="js/world/Materials.js" type="module"></script>

        vec4 addedLights = vec4(0.0,
        0.0,
        0.0,
        1.0);
        for (int l = 0; l < NUM_POINT_LIGHTS; l++) {
            vec3 distanceVec = vPosition - pointLights[l].position;
            distanceVec = distanceVec * 2.0;
            float lightDistance = float(pointLights[l].distance);
            vec3 lightDirection = normalize(distanceVec);
            float attuanation = 0.0;
            if(lightDistance >= length(distanceVec)){
                attuanation = pow((1.0 - (length(distanceVec) / lightDistance)), 2.0);
            }

            if (terrainType != 0) {
                addedLights.rgb += clamp(dot(-lightDirection, norm), 0.0, 1.0) * (pointLights[l].color * attuanation);
            } else {
                addedLights.rgb += clamp(dot(-lightDirection, vNormal), 0.0, 1.0) * (pointLights[l].color * attuanation);
            }
        }
        addedLights = max(vec4(0.3), addedLights);
        addedLights = min(vec4(1.5), addedLights);

        // gl_FragColor = vec4(yeTangent, 1.) * addedLights;
        gl_FragColor = vec4(terrainColor, 1.) * addedLights;
        // gl_FragColor = vec4(norm, 1.);
        // gl_FragColor = vec4(worldPosition.y, worldPosition.y, worldPosition.y, 1.) * addedLights;
    }
</script>
<div id="holder" style="display: flex; background-color: black; flex-direction: row; justify-content: flex-end;">
    <div style="background-color: black" id="leftBar">
        <div style="background-color: black" id="chartHolder">
        </div>
        <div>
            <div style="text-align: center; padding: 10px">
                <div style="font-size: 18pt; color: aliceblue">Timescale</div>
                <input onchange="simulationSpeedChange()" style="width: 100%;" type="range" min="0.1" max="200"
                       value="20" step="0.1" class="slider" id="timescale-slider">
            </div>
            <div style="text-align: center; padding: 10px">
                <button onclick="simulationToggle()" class="button" style="font-size: 20pt" id="stop-sim-button">Pause
                    Simulation
                </button>
            </div>
        </div>
    </div>

    <div style="background-color: black" id="midBar"></div>

    <div style="background-color: black; width: 320px; margin-top: 200px" id="rightBar">
        <div style="text-align: center; margin: 15px">
            <input type="checkbox" id="brush"><label style="color: white" for="brush">Brush</label>
            <input type="checkbox" id="eraser"><label style="color: white" for="eraser">Eraser</label>
        </div>
        <select name="brushElements" id="brushElements" class="list-choice" style="width: 100%">
            <option value="human">Human</option>
            <option value="wall">Wall</option>
            <option value="squirrel">Squirrel</option>
            <option value="tree">Tree</option>
        </select>

        <button id='saveButton' class="btn" style="font-size: 14pt"><i class="fa fa-download"></i> Save Template</button>
        <input id='fileid' type='file' hidden/>
        <input id='loadButton' type='button' value='Load Template'  style="font-size : 19px" />

    </div>
</div>
</body>
</html>